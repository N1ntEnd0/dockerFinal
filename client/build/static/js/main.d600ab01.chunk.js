(this.webpackJsonpgd_api_client=this.webpackJsonpgd_api_client||[]).push([[0],{120:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),o=n(12),r=n.n(o),i=(n(72),n(73),n(74),n(13)),s=n(41),u=n.n(s),l=n(126),d=n(11),j="access/SET_ACCESS",h=n(10),b=n.n(h),f="api",O=b.a.create({withCredentials:!0,baseURL:"".concat(f,"/api")});O.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e}));var _=n(3),p=n(43),g=n.n(p),v=n(58),x=function(){var e=Object(v.a)(g.a.mark((function e(t,n){var a,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",b()({method:"POST",url:"".concat(f,"/api/auth/social/o/google-oauth2/?state=").concat(t,"&code=").concat(n),headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},withCredentials:!0}));case 4:e.prev=4,e.t0=e.catch(0),console.log(null===(a=e.t0.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.details);case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t,n){return e.apply(this,arguments)}}(),m="auth/SET_STATUS",C=n(2),S=function(){var e=Object(d.b)(),t=Object(_.c)();Object(a.useEffect)((function(){var n=new URLSearchParams(t.search);n.has("state")&&n.has("code")&&x(n.get("state"),n.get("code")).then((function(t){return e({type:m,payload:!0}),t})).then((function(t){var n;e((n=t.data.access,{type:j,payload:n})),window.location.href="".concat(f,"/")})).catch((function(e){console.log(e)}))}),[t.search]);return Object(C.jsxs)("header",{className:u.a.Header,children:[Object(C.jsx)("h1",{className:u.a.Header__title,children:"Google Share"}),Object(C.jsx)(l.a,{label:"\u0412\u043e\u0439\u0442\u0438",onClick:function(){b()({method:"GET",url:"".concat(f,"/api/auth/social/o/google-oauth2"),params:{redirect_uri:"http://localhost:3000/"},withCredentials:!0}).then((function(e){return e.data.authorization_url})).then((function(e){window.location.href=e}))}})]})},F=n(59),w=n.n(F),k=function(e){var t=e.items,n=Object(d.c)((function(e){return e.accessToken.accessToken}));return Object(C.jsxs)("div",{className:w.a.Footer,children:[Object(C.jsx)(l.a,{onClick:function(){b()({method:"POST",url:"".concat(f,"/api/v1/files/").concat(t.id,"/download/"),headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){var t=document.createElement("a");t.href=e.data.download_url,t.setAttribute("download","123"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))},label:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"}),Object(C.jsx)("span",{children:t.name})]})},T=n(60),y=n.n(T),N=n(6),I=n(20),E=n.n(I),M=n(47),z=n(22),H=n(23),P=n.n(H),A=n(127),B=n(128),L=n(33),R=n(61),G=n.n(R),U=c.a.forwardRef((function(e,t){var n=e.file,c=e.onClick,o=Object(a.useState)(!1),r=Object(N.a)(o,2),i=r[0],s=r[1],u=Object(a.useState)(!1),l=Object(N.a)(u,2),d=l[0],j=l[1],h=Object(a.useState)(!1),b=Object(N.a)(h,2),f=b[0],O=b[1],_=Object(a.useRef)(null),p=function(e){c(e,s)};return Object(C.jsxs)("div",{className:G()(P.a.File,Object(z.a)({},P.a.File_selected,i)),onMouseOver:function(){return j(!0)},onMouseOut:function(){return j(!1)},onClick:function(){return p(n)},ref:t,children:[i&&Object(C.jsx)("div",{className:P.a.File__icon,children:d?Object(C.jsx)(L.a,{size:"s"}):Object(C.jsx)(B.a,{size:"s"})}),Object(C.jsx)("img",{src:"https://findicons.com/files/icons/2813/flat_jewels/512/file.png",height:"100",width:"100"}),Object(C.jsx)("div",{className:P.a.File__name,ref:_,onMouseOver:function(){return O(!0)},onMouseOut:function(){return O(!1)},children:n.name}),f&&Object(C.jsx)(A.a,{className:P.a.File__tip,direction:"downCenter",size:"s",anchorRef:_,children:n.name})]},n.id)})),q=n(25),D=function(){var e=Object(a.useState)(1),t=Object(N.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),r=Object(N.a)(o,2),i=r[0],s=r[1],u=Object(a.useState)([]),l=Object(N.a)(u,2),j=l[0],h=l[1],O=Object(d.c)((function(e){return e.authStatus.authStatus})),_=function(e,t){var n=Object(a.useState)(!0),c=Object(N.a)(n,2),o=c[0],r=c[1],i=Object(a.useState)(!1),s=Object(N.a)(i,2),u=s[0],l=s[1],j=Object(a.useState)([]),h=Object(N.a)(j,2),O=h[0],_=h[1],p=Object(a.useState)(!1),g=Object(N.a)(p,2),v=g[0],x=g[1],m=Object(d.c)((function(e){return e.accessToken.accessToken}));return Object(a.useEffect)((function(){if(e){r(!0),l(!1);var n=new AbortController;return b()({method:"GET",url:"".concat(f,"/api/v1/files/"),params:{page:t,page_size:10},signal:n.signal,headers:{Authorization:"Bearer ".concat(m)}}).then((function(e){_((function(t){return[].concat(Object(M.a)(t),Object(M.a)(e.data.results))})),x(null!==e.data.next),r(!1)})).catch((function(e){b.a.isCancel(e)||l(!0)})),function(){return n.abort()}}}),[t]),{loading:o,error:u,files:O,hasMore:v}}(O,n),p=_.files,g=_.hasMore,v=_.loading,x=_.error,m=Object(a.useRef)(),S=Object(a.useCallback)((function(e){v||(m.current&&m.current.disconnect(),m.current=new IntersectionObserver((function(e){e[0].isIntersecting&&g&&c((function(e){return e+1}))})),e&&m.current.observe(e))}),[v,g]),F=function(e,t){j===e&&(h([]),s(!1),t(!1)),j===e||i||(h(e),s(!0),t(!0)),j!==e&&i&&q.b.error("\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e 1 \u0444\u0430\u0439\u043b",{position:"top-right"})};return Object(C.jsxs)("div",{className:E.a.Content,children:[Object(C.jsx)("div",{className:E.a.Container,children:p.map((function(e,t){return p.length===t+1?Object(C.jsx)(U,{onClick:function(e,t){return F(e,t)},file:e,ref:S}):Object(C.jsx)(U,{file:e,onClick:function(e,t){return F(e,t)}})}))}),Object(C.jsx)("div",{className:E.a.Info,children:O?Object(C.jsxs)("div",{children:[Object(C.jsx)("div",{className:E.a.Info__loading,children:v&&"Loading..."}),Object(C.jsx)("div",{className:E.a.Info__error,children:x&&"Error..."})]}):Object(C.jsx)("div",{className:E.a.Info__auth,children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0434\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0444\u0430\u0439\u043b\u043e\u0432"})}),i&&Object(C.jsx)(k,{items:j})]})},J=function(){return Object(C.jsxs)("div",{className:y.a.MainPage,children:[Object(C.jsx)(S,{}),Object(C.jsx)(D,{}),Object(C.jsx)(q.a,{})]})},W=n(65);var X=function(){return Object(C.jsx)(W.a,{children:Object(C.jsx)(i.a,{preset:i.e,children:Object(C.jsx)(J,{})})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,129)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))},Z=n(62),K=n(18),Q=n(63),V=n(64),$=n(45),ee=n(46),te=n.n(ee),ne=n(19),ae={key:"accessToken",storage:new $.CookieStorage(te.a,{expiration:{default:86400}}),whitelist:["accessToken"]},ce={key:"authStatus",storage:new $.CookieStorage(te.a,{expiration:{default:86400}}),whitelist:["authStatus"]},oe=Object(K.b)({accessToken:Object(ne.a)(ae,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{accessToken:""},t=arguments.length>1?arguments[1]:void 0;return t.type===j?{accessToken:t.payload}:e})),authStatus:Object(ne.a)(ce,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authStatus:!1},t=arguments.length>1?arguments[1]:void 0;return t.type===m?{authStatus:t.payload}:e}))}),re=Object(K.c)(oe,Object(K.a)(Q.a)),ie=Object(V.a)(re,{});r.a.render(Object(C.jsx)(d.a,{store:re,children:Object(C.jsx)(Z.a,{persistor:ie,children:Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(X,{})})})}),document.getElementById("root")),Y()},20:function(e,t,n){e.exports={Content:"Content_Content__20LeB",Container:"Content_Container__1GHiz",Info:"Content_Info__1YcWL"}},23:function(e,t,n){e.exports={File:"File_File__3xmFo",File__icon:"File_File__icon__3HZi1",File__name:"File_File__name__1ugq0",File__tip:"File_File__tip__1mD-R",File_selected:"File_File_selected__3eIGn"}},41:function(e,t,n){e.exports={Header:"Header_Header__1CTzX",Header__title:"Header_Header__title__3B4qP"}},59:function(e,t,n){e.exports={Footer:"Footer_Footer__37hEc"}},60:function(e,t,n){e.exports={MainPage:"MainPage_MainPage__2bW37"}},72:function(e,t,n){},73:function(e,t,n){}},[[120,1,2]]]);
//# sourceMappingURL=main.d600ab01.chunk.js.map